<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 630" fill="none">
  <style>
    @media (prefers-color-scheme: dark) {
      .bg { fill: #0e0c0a; }
      .text-primary { fill: #ede7df; }
      .text-secondary { fill: #9a8e82; }
      .accent { fill: #daa04e; }
      .accent-stroke { stroke: #daa04e; }
      .box-bg { fill: #1a1714; }
      .box-stroke { stroke: rgba(237,231,223,0.08); }
      .green { fill: #6ade8a; }
      .blue { fill: #6ab4de; }
      .purple { fill: #b48ade; }
      .gold { fill: #daa04e; }
      .gold-bg { fill: #daa04e; fill-opacity: 0.1; }
      .line { stroke: #3a3530; }
    }
    @media (prefers-color-scheme: light) {
      .bg { fill: #f8f4ee; }
      .text-primary { fill: #1a1410; }
      .text-secondary { fill: #6e6259; }
      .accent { fill: #c48a3f; }
      .accent-stroke { stroke: #c48a3f; }
      .box-bg { fill: #f0ebe3; }
      .box-stroke { stroke: rgba(26,20,16,0.1); }
      .green { fill: #2a9e4a; }
      .blue { fill: #3a7fbf; }
      .purple { fill: #7a3abf; }
      .gold { fill: #c48a3f; }
      .gold-bg { fill: #c48a3f; fill-opacity: 0.08; }
      .line { stroke: #e8e0d4; }
    }
  </style>
  <rect class="bg" width="1200" height="630"/>

  <!-- Crown / Premium icon -->
  <polygon class="gold" points="560,35 575,60 590,38 605,60 620,35 625,75 555,75" opacity="0.8"/>
  <rect class="gold" x="555" y="75" width="70" height="8" rx="3" opacity="0.6"/>

  <!-- Flow: User → App → RevenueCat → Stores → Supabase -->
  <!-- User -->
  <rect class="box-bg" x="60" y="120" width="180" height="90" rx="14"/>
  <rect class="box-stroke" x="60" y="120" width="180" height="90" rx="14" fill="none" stroke-width="1.5"/>
  <text class="text-primary" x="150" y="155" text-anchor="middle" font-family="system-ui,sans-serif" font-size="15" font-weight="700">User</text>
  <text class="text-secondary" x="150" y="178" text-anchor="middle" font-family="system-ui,sans-serif" font-size="11">Taps "Subscribe"</text>
  <text class="text-secondary" x="150" y="195" text-anchor="middle" font-family="system-ui,sans-serif" font-size="11">on Paywall</text>

  <!-- Arrow -->
  <line class="line" x1="240" y1="165" x2="290" y2="165" stroke-width="2"/>
  <polygon class="accent" points="288,158 298,165 288,172"/>

  <!-- Flutter App -->
  <rect class="gold-bg" x="300" y="100" width="240" height="130" rx="14"/>
  <rect class="accent-stroke" x="300" y="100" width="240" height="130" rx="14" fill="none" stroke-width="2"/>
  <text class="gold" x="420" y="132" text-anchor="middle" font-family="system-ui,sans-serif" font-size="15" font-weight="700">Flutter App</text>
  <text class="text-secondary" x="320" y="157" font-family="monospace" font-size="10">PremiumRepository</text>
  <text class="text-secondary" x="320" y="175" font-family="monospace" font-size="10">PremiumService</text>
  <text class="text-secondary" x="320" y="193" font-family="monospace" font-size="10">PremiumGate widget</text>
  <text class="text-secondary" x="320" y="211" font-family="monospace" font-size="10">PaywallScreen</text>

  <!-- Arrow -->
  <line class="line" x1="540" y1="165" x2="590" y2="165" stroke-width="2"/>
  <polygon class="accent" points="588,158 598,165 588,172"/>

  <!-- RevenueCat -->
  <rect class="box-bg" x="600" y="100" width="240" height="130" rx="14"/>
  <rect class="purple" x="600" y="100" width="240" height="130" rx="14" fill-opacity="0.1"/>
  <rect x="600" y="100" width="240" height="130" rx="14" fill="none" stroke-width="2" class="box-stroke"/>
  <text class="purple" x="720" y="132" text-anchor="middle" font-family="system-ui,sans-serif" font-size="15" font-weight="700">RevenueCat</text>
  <text class="text-secondary" x="620" y="157" font-family="system-ui,sans-serif" font-size="11">Handles all IAP logic</text>
  <text class="text-secondary" x="620" y="175" font-family="system-ui,sans-serif" font-size="11">Caches entitlements</text>
  <text class="text-secondary" x="620" y="193" font-family="system-ui,sans-serif" font-size="11">Receipt validation</text>
  <text class="text-secondary" x="620" y="211" font-family="system-ui,sans-serif" font-size="11">Cross-platform unified</text>

  <!-- Arrow to stores -->
  <line class="line" x1="840" y1="145" x2="890" y2="130" stroke-width="2"/>
  <line class="line" x1="840" y1="185" x2="890" y2="200" stroke-width="2"/>

  <!-- App Store -->
  <rect class="box-bg" x="900" y="100" width="240" height="50" rx="10"/>
  <rect class="box-stroke" x="900" y="100" width="240" height="50" rx="10" fill="none" stroke-width="1"/>
  <text class="blue" x="1020" y="130" text-anchor="middle" font-family="system-ui,sans-serif" font-size="13" font-weight="600">Apple App Store</text>

  <!-- Play Store -->
  <rect class="box-bg" x="900" y="170" width="240" height="50" rx="10"/>
  <rect class="box-stroke" x="900" y="170" width="240" height="50" rx="10" fill="none" stroke-width="1"/>
  <text class="green" x="1020" y="200" text-anchor="middle" font-family="system-ui,sans-serif" font-size="13" font-weight="600">Google Play Store</text>

  <!-- Webhook flow -->
  <line class="line" x1="720" y1="230" x2="720" y2="280" stroke-width="2" stroke-dasharray="4 3"/>
  <text class="text-secondary" x="740" y="260" font-family="system-ui,sans-serif" font-size="10">webhook</text>

  <!-- Supabase -->
  <rect class="box-bg" x="560" y="285" width="320" height="90" rx="14"/>
  <rect class="green" x="560" y="285" width="320" height="90" rx="14" fill-opacity="0.1"/>
  <rect class="box-stroke" x="560" y="285" width="320" height="90" rx="14" fill="none" stroke-width="1.5"/>
  <text class="green" x="720" y="315" text-anchor="middle" font-family="system-ui,sans-serif" font-size="15" font-weight="700">Supabase (Optional)</text>
  <text class="text-secondary" x="580" y="340" font-family="monospace" font-size="11">Edge Function → subscriptions table</text>
  <text class="text-secondary" x="580" y="358" font-family="system-ui,sans-serif" font-size="11">Cross-device sync + admin dashboard</text>

  <!-- Event mapping table -->
  <rect class="box-bg" x="60" y="270" width="450" height="130" rx="12"/>
  <rect class="box-stroke" x="60" y="270" width="450" height="130" rx="12" fill="none" stroke-width="1"/>
  <text class="accent" x="80" y="298" font-family="system-ui,sans-serif" font-size="13" font-weight="700">Event Mapping</text>

  <text class="green" x="80" y="322" font-family="monospace" font-size="11">INITIAL_PURCHASE → ACTIVE</text>
  <text class="green" x="80" y="340" font-family="monospace" font-size="11">RENEWAL         → ACTIVE</text>
  <text class="text-secondary" x="80" y="358" font-family="monospace" font-size="11">CANCELLATION    → EXPIRED</text>
  <text class="text-secondary" x="80" y="376" font-family="monospace" font-size="11">EXPIRATION      → EXPIRED</text>

  <text class="blue" x="310" y="322" font-family="monospace" font-size="11">PAUSED   → PAUSED</text>
  <text class="purple" x="310" y="340" font-family="monospace" font-size="11">LIFETIME → LIFETIME</text>
  <text class="text-secondary" x="310" y="358" font-family="monospace" font-size="11">BILLING  → ignore</text>
  <text class="text-secondary" x="310" y="376" font-family="monospace" font-size="11">TRANSFER → ignore</text>

  <!-- Title -->
  <text class="text-primary" x="600" y="470" text-anchor="middle" font-family="system-ui,sans-serif" font-size="36" font-weight="800">RevenueCat Subscriptions</text>
  <text class="accent" x="600" y="510" text-anchor="middle" font-family="system-ui,sans-serif" font-size="20" font-weight="500">Paywall  ·  Entitlements  ·  Webhooks  ·  Premium Gate</text>
  <text class="text-secondary" x="600" y="600" text-anchor="middle" font-family="system-ui,sans-serif" font-size="14">Flutter + RevenueCat + Supabase</text>
</svg>
